# Task Management API Documentation

## Overview

The Task Management API is a RESTful service for creating, reading, updating, and deleting tasks. It uses MongoDB as its persistent data storage and is built with Go and the Gin web framework.

---

## Table of Contents

1. [Getting Started](#getting-started)
2. [MongoDB Configuration](#mongodb-configuration)
3. [Task Model](#task-model)
4. [API Endpoints](#api-endpoints)
    - [GET /tasks](#get-tasks)
    - [GET /tasks/:id](#get-tasksid)
    - [POST /tasks](#post-tasks)
    - [PUT /tasks/:id](#put-tasksid)
    - [DELETE /tasks/:id](#delete-tasksid)
5. [Error Handling](#error-handling)
6. [How the API Interacts with MongoDB](#how-the-api-interacts-with-mongodb)
7. [Example Usage](#example-usage)
8. [Troubleshooting](#troubleshooting)

---

## Getting Started

### Prerequisites

- Go 1.18 or later
- MongoDB (local or remote instance)
- (Optional) [MongoDB Compass](https://www.mongodb.com/products/compass) for GUI access

### Installation & Setup

1. **Clone the repository** and navigate to the project directory.

2. **Install dependencies** (if not already done):
   ```sh
   go mod tidy
   ```

3. **Configure MongoDB connection** (optional):
   - By default, the API connects to `mongodb://localhost:27017`.
   - To use a different MongoDB instance, set the `MONGODB_URI` environment variable:
     - **Linux/macOS:**
       ```sh
       export MONGODB_URI="mongodb://your-mongodb-host:27017"
       ```
     - **Windows PowerShell:**
       ```powershell
       $env:MONGODB_URI="mongodb://your-mongodb-host:27017"
       ```

4. **Start the API server:**
   ```sh
   go run main.go
   ```
   The server will run on `http://localhost:8080`.

---

## MongoDB Configuration

- **Database:** `taskdb`
- **Collection:** `tasks`
- The API will automatically create the database and collection if they do not exist.

---

## Task Model

Tasks are stored in MongoDB with the following structure:

```json
{
  "id": "ObjectID (string, generated by MongoDB)",
  "title": "Task Title",
  "description": "Task Description",
  "due_date": "YYYY-MM-DD",
  "status": "pending | completed | ... (string)"
}
```

- The `id` field is a MongoDB ObjectID, returned as a string in API responses.

---

## API Endpoints

### GET /tasks

- **Description:** Retrieve a list of all tasks.
- **Response:**
  - `200 OK`
  - Body: Array of task objects

```json
[
  {
    "id": "60c72b2f9b1e8b6f8f0e4b1a",
    "title": "Task Title",
    "description": "Task Description",
    "due_date": "2024-06-01",
    "status": "pending"
  }
]
```

---

### GET /tasks/:id

- **Description:** Retrieve a specific task by its MongoDB ObjectID.
- **Parameters:**  
  - `id` (string, required): The ObjectID of the task.
- **Response:**
  - `200 OK` with task object
  - `404 Not Found` if the task does not exist
  - `400 Bad Request` if the ID is invalid

```json
{
  "id": "60c72b2f9b1e8b6f8f0e4b1a",
  "title": "Task Title",
  "description": "Task Description",
  "due_date": "2024-06-01",
  "status": "pending"
}
```

---

### POST /tasks

- **Description:** Create a new task.
- **Request Body:**
```json
{
  "title": "Task Title",
  "description": "Task Description",
  "due_date": "2024-06-01",
  "status": "pending"
}
```
- **Response:**
  - `201 Created` with the created task (including generated `id`)
  - `400 Bad Request` if the request is invalid

---

### PUT /tasks/:id

- **Description:** Update an existing task by its ObjectID.
- **Parameters:**  
  - `id` (string, required): The ObjectID of the task.
- **Request Body:**
```json
{
  "title": "Updated Title",
  "description": "Updated Description",
  "due_date": "2024-06-02",
  "status": "completed"
}
```
- **Response:**
  - `200 OK` with the updated task
  - `400 Bad Request` if the request or ID is invalid
  - `404 Not Found` if the task does not exist

---

### DELETE /tasks/:id

- **Description:** Delete a task by its ObjectID.
- **Parameters:**  
  - `id` (string, required): The ObjectID of the task.
- **Response:**
  - `204 No Content` on success
  - `404 Not Found` if the task does not exist
  - `400 Bad Request` if the ID is invalid

---

## Error Handling

- All errors are returned as JSON objects:
```json
{
  "error": "Error message"
}
```
- Common error codes:
  - `400 Bad Request`: Invalid input or ID format
  - `404 Not Found`: Task not found
  - `500 Internal Server Error`: Database or server error

---

## How the API Interacts with MongoDB

- **Create:** Inserts a new document into the `tasks` collection.
- **Read:** Queries the `tasks` collection by ObjectID or fetches all documents.
- **Update:** Updates fields of a document by ObjectID.
- **Delete:** Removes a document by ObjectID.
- All operations use context timeouts for reliability and proper resource management.

---

## Example Usage

**Create a Task:**
```sh
curl -X POST http://localhost:8080/tasks \
  -H "Content-Type: application/json" \
  -d '{"title":"Test Task","description":"Try MongoDB","due_date":"2024-06-10","status":"pending"}'
```

**Get All Tasks:**
```sh
curl http://localhost:8080/tasks
```

**Get a Task by ID:**
```sh
curl http://localhost:8080/tasks/<task_id>
```

**Update a Task:**
```sh
curl -X PUT http://localhost:8080/tasks/<task_id> \
  -H "Content-Type: application/json" \
  -d '{"title":"Updated Task","description":"Updated desc","due_date":"2024-06-12","status":"completed"}'
```

**Delete a Task:**
```sh
curl -X DELETE http://localhost:8080/tasks/<task_id>
```

---

## Troubleshooting

- **MongoDB Connection Issues:**  
  Ensure MongoDB is running and accessible at the URI specified by `MONGODB_URI`.
- **Invalid ObjectID:**  
  Use the `id` returned by the API for all operations requiring an ID.
- **Data Not Persisting:**  
  Check MongoDB logs and ensure the correct database/collection is being used.

---

If you have further questions or need help, please refer to the codebase or contact the maintainer.
